"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.MfaTokenCache = void 0;
class MfaTokenCache {
    constructor() {
        this.cache = {};
    }
    has(mfaSerial, token) {
        if (this.cache[mfaSerial]) {
            return this.cache[mfaSerial].includes(token);
        }
        return false;
    }
    set(mfaSerial, token) {
        if (this.cache[mfaSerial]) {
            this.cache[mfaSerial].push(token);
            return;
        }
        this.cache[mfaSerial] = [token];
    }
}
exports.MfaTokenCache = MfaTokenCache;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWZhLXRva2VuLWNhY2hlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL21mYS10b2tlbi1jYWNoZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxNQUFhLGFBQWE7SUFHeEI7UUFDRSxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBRU0sR0FBRyxDQUFDLFNBQWlCLEVBQUUsS0FBYTtRQUN6QyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDekIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUM5QztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVNLEdBQUcsQ0FBQyxTQUFpQixFQUFFLEtBQWE7UUFDekMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ3pCLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2xDLE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsQyxDQUFDO0NBQ0Y7QUFyQkQsc0NBcUJDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIE1mYVRva2VuQ2FjaGUge1xuICBwcml2YXRlIHJlYWRvbmx5IGNhY2hlOiB7IFttZmFTZXJpYWw6IHN0cmluZ106IHN0cmluZ1tdIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jYWNoZSA9IHt9O1xuICB9XG5cbiAgcHVibGljIGhhcyhtZmFTZXJpYWw6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmNhY2hlW21mYVNlcmlhbF0pIHtcbiAgICAgIHJldHVybiB0aGlzLmNhY2hlW21mYVNlcmlhbF0uaW5jbHVkZXModG9rZW4pO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwdWJsaWMgc2V0KG1mYVNlcmlhbDogc3RyaW5nLCB0b2tlbjogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2FjaGVbbWZhU2VyaWFsXSkge1xuICAgICAgdGhpcy5jYWNoZVttZmFTZXJpYWxdLnB1c2godG9rZW4pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmNhY2hlW21mYVNlcmlhbF0gPSBbdG9rZW5dO1xuICB9XG59XG4iXX0=